{% macro product_card(product) %}
<div class="card h-100 shadow-sm border-0">
    <!-- === IMAGE === -->
    {% if product.image_bytes %}
        <img src="data:image/jpeg;base64,{{ product.image_bytes|b64encode }}"
             class="card-img-top" alt="{{ product.name }}" style="height:200px; object-fit:cover;">
    {% else %}
        <div class="d-flex align-items-center justify-content-center bg-light"
             style="height:200px;">
            <i class="fa fa-image fa-3x text-muted"></i>
        </div>
    {% endif %}

    <!-- === BODY === -->
    <div class="card-body d-flex flex-column">
        <h5 class="card-title">{{ product.name }}</h5>
        <p class="card-text small flex-grow-1">
            {% if product.description %}
                {% if product.description|length > 100 %}
                    {{ product.description[:100] }}...
                {% else %}
                    {{ product.description }}
                {% endif %}
            {% endif %}
        </p>

        <ul class="list-unstyled mt-auto mb-2">
            <li><strong>Category:</strong> {{ product.category }}</li>
            <li><strong>Size:</strong> {{ product.size }}</li>
            <li><strong>Price:</strong> R {{ "%.2f"|format(product.price) }}</li>
            <li>
                <strong>Stock:</strong>
                {% if product.stock > 0 %}
                    <span class="badge bg-success">{{ product.stock }} available</span>
                {% else %}
                    <span class="badge bg-danger">Out of stock</span>
                {% endif %}
            </li>
        </ul>

        <!-- â™¥ WISH-LIST - COMING SOON -->
        <div class="mb-2">
            <button class="btn btn-sm btn-outline-danger wishlist-coming-soon" 
                    type="button" 
                    title="Add to wishlist"
                    data-product-id="{{ product.id }}">
                <i class="far fa-heart"></i>
                <span class="ms-1">Add to Wishlist</span>
            </button>
            <span class="wishlist-message text-info small ms-2" style="display: none;">
                <i class="fas fa-clock"></i> Coming soon!
            </span>
        </div>

        <!-- === ACTION BUTTONS (same colours & borders) === -->
        <div class="d-flex justify-content-between align-items-center">
            <a href="{{ url_for('products.details', id=product.id) }}"
               class="btn btn-outline-primary btn-sm border-inner">
                View
            </a>
            {% if current_user.is_authenticated and current_user.is_admin %}
                <a href="{{ url_for('products.edit', id=product.id) }}"
                   class="btn btn-primary btn-sm border-inner">
                    Edit
                </a>
            {% endif %}
        </div>
    </div>
</div>
{% endmacro %}

<!-- === WISH-LIST COMING SOON SCRIPT === -->
<script>
    $(document).ready(function() {
        $(".wishlist-coming-soon").on("click", function (e) {
            e.preventDefault();
            var btn = $(this);
            var message = btn.siblings(".wishlist-message");
            
            // Show the coming soon message
            message.fadeIn(200).delay(2000).fadeOut(200);
            
            // Optional: animate the heart icon
            btn.find("i").removeClass("far fa-heart").addClass("fas fa-heart");
            setTimeout(function() {
                btn.find("i").removeClass("fas fa-heart").addClass("far fa-heart");
            }, 1000);
        });
    });
</script>